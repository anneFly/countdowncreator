var Utils=function(t,e,n){"use strict";return n.maxValues={year:3e3,month:12,day:31,hour:23,minute:59},n.minValues={year:(new Date).getFullYear(),month:1,day:1,hour:0,minute:0},n.labels={days:{sg:"day",pl:"days"},hours:{sg:"hour",pl:"hours"},minutes:{sg:"minute",pl:"minutes"},seconds:{sg:"second",pl:"seconds"}},n.checkInput=function(t,e){return""!==e&&e>=n.minValues[t]&&n.maxValues[t]>=e},n.checkDate=function(t,e,n){var i=new Date(parseInt(t,10),parseInt(e,10)-1,parseInt(n,10)),a=i.getFullYear()===parseInt(t,10),r=i.getMonth()===parseInt(e,10)-1,o=i.getDate()===parseInt(n,10);return a&&r&&o},n.validateForm=function(e){var i={},a=!0;return t.each(e,function(e,n){var a=t(n).data("validate"),r=t(n).val();i[a]=r}),t.each(i,function(t,i){var r=n.checkInput(t,parseInt(i,10));e.filter(['[data-validate="',t,'"]'].join("")).toggleClass("invalid",!r),a=a&&r}),a?n.checkDate(i.year,i.month,i.day):!1},n.getCountdownData=function(e){var n={};return t.each(e,function(e,i){var a=t(i).attr("name"),r=t(i).val();n[a]=r}),n},n.getLabel=function(t,e){return 1===e?n.labels[t].sg:n.labels[t].pl},n}(jQuery,this,this.Utils||{}),Countdown=function(t,e,n,i,a,r){"use strict";e.Ui=e.Ui||i;var o=function(t){this.title=t.title,this.year=parseInt(t.year,10),this.month=parseInt(t.month,10),this.day=parseInt(t.day,10),this.hour=parseInt(t.hour,10),this.minute=parseInt(t.minute,10),this.cdTime=this.getCdTime(),this.timer=r};return o.prototype.getCdTime=function(){return new Date(this.year,this.month-1,this.day,this.hour,this.minute).getTime()},o.prototype.calculateCountdown=function(){var t=Date.now(),e=this.cdTime>t?this.cdTime-t:0,n=0|e/1e3/60/60/24,i=(0|e/1e3/60/60)-(0|24*n),a=(0|e/1e3/60)-(0|60*24*n)-(0|60*i),r=(0|e/1e3)-(0|60*60*24*n)-(0|60*60*i)-(0|60*a);return{title:this.title,days:n,hours:i,minutes:a,seconds:r}},o.prototype.count=function(){var t=this.calculateCountdown();i.updateView(t),0===t.days&&0===t.hours&&0===t.minutes&&0===t.seconds&&this.stopCounting()},o.prototype.startCounting=function(){var t=this;this.timer=e.setInterval(function(){t.count()},1e3)},o.prototype.stopCounting=function(){var t=this;e.clearInterval(t.timer)},a.create=function(t){return new o(t)},a.createFromDate=function(t){var e=t.date.split(" "),n=e[0],i=n.split("-"),a=e[1],r=a.split(":"),s={title:t.title,year:i[0],month:i[1],day:i[2],hour:r[0],minute:r[1]};return new o(s)},a}(jQuery,this,this.Utils,this.Ui||{},Countdown||{}),Ui=function(t,e,n,i,a,r){"use strict";i=e.Countdown||{};var o=function(t){this.init(t),this.bindEvents()};o.prototype.init=function(e){this.type=e.type,this.$el=t(e.selector),this.$input=this.$el.find("input"),this.maxValue=n.maxValues[this.type],this.minValue=n.minValues[this.type],this.value=""!==this.$input.val()?parseInt(this.$input.val(),10):e.value,this.renderValue()},o.prototype.bindEvents=function(){var e=this,i={add:function(t){return t+=1},sub:function(t){return t-=1}};this.$el.on("click","button",function(){return""===e.$input.val()?(e.renderValue(),void 0):(e.value=""!==e.$input.val()?parseInt(e.$input.val(),10):e.value,e.value=i[t(this).data("role")](e.value),n.checkInput(e.type,e.value)?(e.renderValue(),void 0):(e.value=i[t(this).data("undorole")](e.value),void 0))}),this.$input.on("blur",function(){return n.checkInput(e.type,t(this).val())?(e.value=t(this).val(),e.renderValue(),!0):(e.value=t(this).val()>e.maxValue?e.maxValue:e.minValue,e.renderValue(),void 0)})},o.prototype.renderValue=function(){var t,e=parseInt(this.$input.attr("maxlength"),10),n=(""+this.value).length,i=[];for(t=0;e-n>t;t++)i.push("0");this.$input.val([i.join(""),this.value].join(""))};var s=function(e){this.$el=t(e.selector),this.$fields={title:this.$el.find('[data-insert="title"]')};var n=["days","hours","minutes","seconds"],i=0;for(i;n.length>i;i++)this.$fields[n[i]]=[this.$el.find(['[data-insert="',n[i],'"] .cd-number'].join("")),this.$el.find(['[data-insert="',n[i],'"] .cd-label'].join(""))]},u=function(e){this.$el=t(e.selector)},l=function(e){var r=this;this.$el=t(e.selector),this.$validateFields=t(e.requiredFields),this.$previewBtn=t(e.previewBtn),this.$editBtn=t(e.editBtn),this.inputView=new u({selector:e.inputViewSelector}),this.$el.on("submit",function(){return n.validateForm(r.$validateFields)}),this.$previewBtn.on("click",function(){var t=n.validateForm(r.$validateFields);if(t){r.$el.removeClass("error");var e=n.getCountdownData(r.$el.find("input"));a.Cd=i.create(e),a.Cd.startCounting(),r.toggleView(r.inputView.$el,a.countdownView.$el)}else r.$el.addClass("error")}),this.$editBtn.on("click",function(){a.Cd.stopCounting(),r.toggleView(a.countdownView.$el,r.inputView.$el)})};l.prototype.toggleView=function(t,e){var n=this;t.fadeOut(function(){e.fadeIn(),n.$el.toggleClass("preview-mode")})};var h=function(e){this.$urlField=t(e.urlField),this.init()};return h.prototype.init=function(){var t=e.location.protocol,n=e.location.hostname,i=e.location.origin||[t,"//",n].join(""),a=this.$urlField.val(),r=[i,a].join("");this.$urlField.val(r)},a.updateView=function(e){t.each(e,function(t,e){if("title"!==t){var i=n.getLabel(t,e);a.countdownView.$fields[t][0].text(e),a.countdownView.$fields[t][1].text(i)}}),a.countdownView.$fields.title.text(e.title)},a.countdownView=new s({selector:".countdown-container"}),a.form=new l({selector:"form",requiredFields:"[data-validate]",previewBtn:"button.show-preview",editBtn:"button.show-edit",inputViewSelector:".input-container"}),a.fields=[],a.fields.push(new o({selector:"#yearWrapper",type:"year",value:(new Date).getFullYear()}),new o({selector:"#monthWrapper",type:"month",value:(new Date).getMonth()+1}),new o({selector:"#dayWrapper",type:"day",value:(new Date).getDate()}),new o({selector:"#hourWrapper",type:"hour",value:(new Date).getHours()}),new o({selector:"#minuteWrapper",type:"minute",value:(new Date).getMinutes()})),a.successView=new h({urlField:".copy-url input"}),e.fetchedCountdown!==r&&(a.Cd=i.createFromDate(e.fetchedCountdown),a.Cd.startCounting()),a}(jQuery,this,this.Utils,this.Countdown||{},this.Ui||{});